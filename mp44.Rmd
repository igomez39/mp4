---
title: "mp4"
author: "Felicia Curtis, Stephanie Foukaris, and Isabel Gomez"
date: "April 25, 2018"
output: 
  html_document:
    code_folding: hide
---
#*DREAMWORKS* Is the Dream Eqaul for All

## Question: Does the company "DREAMWORKS" use an equal number of men and women in their top 5 films from 2010 to 2017?

```{r setup, include=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(mdsr)
library(RMySQL)
db <- dbConnect_scidb(dbname = "imdb")
```

The first step is to find the code number for dreamworks.

```{r message=FALSE, warning=FALSE}
db %>%
  dbGetQuery(" SELECT * 
FROM company_name
WHERE name = 'Dreamworks';")

``` 

Then using this information, we found all of the movies produced by Dreamworks. We did this by using movie_companies and joining it with the table 'titles' Because we are only looking for movies, we select kind_id =1 and the production year to be 2010 or later. 

```{r message=FALSE, warning=FALSE}
db %>%
  dbGetQuery("SELECT *
  FROM movie_companies AS mc
  JOIN title AS t ON t.id = mc.movie_id
  JOIN cast_info AS ci ON ci.movie_id = mc.movie_id
 RIGHT JOIN movie_info AS mi ON mi.movie_id = mc.movie_id
  WHERE company_id = '10667' 
  AND mi.info_type_id = '108'
  AND kind_id = '1' 
  AND production_year >= 2010
  AND (ci.role_id = '1' OR ci.role_id = '2');")
```
