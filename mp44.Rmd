---
title: "Mini Project 4"
author: "Felicia Curtis, Stephanie Foukaris, and Isabel Gomez"
date: "April 25, 2018"
output: 
  html_document:
    code_folding: hide
---

This blog examines gender equality in the film industry and specifically in the company "Dreamworks".  We used GitHub to collaborate with each other. [^1] Enjoy our blog post!


#*DREAMWORKS*: Is the Dream Equal for All

![](https://pmcvariety.files.wordpress.com/2017/01/dreamworks-animation-logo.jpg?w=1000&h=563&crop=1)

### Question: Does the company "DREAMWORKS" use an equal number of men and women in their films and specifically in their top 5 films from 2010 to 2017?

```{r message=FALSE, warning=FALSE, include=TRUE}
#loading all the packages we need for this project
library(tidyverse)
library(ggthemes)
library(RColorBrewer)
library(mdsr)
library(RMySQL)
db <- dbConnect_scidb(dbname = "imdb")
```


```{r include=TRUE, warning=FALSE, message=FALSE}
#This is the final querry we used:
Dataset_Dreamworks <- db %>%
dbGetQuery("SELECT title, production_year, ci.note, ci.role_id, mi.info, COUNT(role_id) 
FROM movie_companies AS mc
  JOIN title AS t ON t.id = mc.movie_id
  JOIN cast_info AS ci ON ci.movie_id = mc.movie_id
JOIN movie_info AS mi ON mi.movie_id = mc.movie_id
WHERE company_id = '10667'
AND mi.info_type_id = '108'
  AND kind_id = '1' 
  AND production_year >= 1996
  AND (ci.role_id = '1' OR ci.role_id = '2')
  AND INSTR(info, 'USA')
  AND ci.note IS NOT NULL
  AND NOT INSTR(ci.note,'uncredited')
  GROUP BY title, role_id
  ORDER BY production_year DESC
 ;")
```


```{r message=FALSE, warning=FALSE, include=TRUE}
#Changed the column name of the column where we count the number of people.
Dataset_Dreamworks1 <- Dataset_Dreamworks %>%
  rename(count_cast = `COUNT(role_id)`)%>%
  rename(Gender = `role_id`)
  
Dataset_Dreamworks2 <- Dataset_Dreamworks1 %>%
  group_by(production_year, Gender) %>%
  summarise(Total_Amount = sum(count_cast))
```

####Graph showing main actors and actresses in the company Dreamworks during years 1996-2017.

```{r message=FALSE, warning=FALSE, include=TRUE}
#Used ggplot to plot number of actors and actresses per year.
gender_differences <- ggplot(data=Dataset_Dreamworks2, aes(y=Total_Amount, x=production_year)) +
  geom_point(aes(color=factor(Gender)))+
  geom_line(aes(color=factor(Gender)))+
  labs(x= "Production Year", y= "Number of Actors/Actresses in Cast", title = "Gender Gap in Top Movies from Dreamwork Productions", color = "Gender")

gender_differences + 
  theme (  title = element_text(family = "Courier", size = 13, face = 'bold'), plot.background = element_rect (fill = "#F7F7F7", colour = "#CCECE6"),
           panel.background = element_rect(fill = "#F7F7F7", colour = "#CCECE6"),
            legend.background = element_rect(fill = "#F7F7F7"))+ scale_colour_manual(labels = c("Female", "Male"), values = c("#B2DF8A", "#FA9FB5"))
```

####This graph shows the proportion of men and women in Dreawork's top 5 movies between 2010-2017.

```{r message=FALSE, warning=FALSE, include=TRUE}
#Created a dataframe showing top 5 movies according to opening date earnings.
title = c("Cowboys & Aliens", "Little Fockers", "Real Steel", "Anchorman 2", "The Help")
gender = c("M","M","M","M","M","F","F","F","F","F")
cast_count = c(5,9,2,7,0,1,5,0,1,4)
Dreamworks_5 = data.frame(title, cast_count, gender)
```


```{r message=FALSE, warning=FALSE, include=TRUE}
#Used ggplot to make a histogram of the total number or main actors and actresses in each of the top 5 movies and colored each bar with the proportion of men and women.
ggplot(data = Dreamworks_5, mapping = aes(x = title, y = cast_count, fill=factor(gender))) + theme_solarized_2() +
  geom_col() +
  scale_y_continuous(expand = c(0, 0), limits = c(0, 15), labels = scales::comma) +
    labs(
    title = "Top Five Films (2010-2017) - Opening Day",
    subtitle = "Dreamworks",
    caption = "Source: IMDB",
    x = "Movie Title",
    y = "Actor/Actress Count",
    fill= "Gender") + 
    theme(title = element_text(family = "Courier", size = 17, face = 'bold'), panel.grid.major = element_blank(), panel.grid.minor = element_blank(), plot.background = element_rect(fill = "#F7F7F7", colour = "#CCECE6"), panel.background = element_rect(fill = "#F7F7F7", colour = "#CCECE6"), legend.background = element_rect(fill = "#F7F7F7"))+
scale_fill_manual(values = c("#FA9FB5","#CCECE6"))
```

[^1]: [This is the link to the github repository](https://github.com/igomez39/mp4.git)
